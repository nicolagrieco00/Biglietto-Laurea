<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Festa di Laurea di Raffaella</title>

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
  <!-- Sfondo rose pulite (metti l'immagine in static/roses-clean.png) -->
  <div class="bg"></div>

  <!-- Testo centrale -->
  <main class="canvas">
    <!-- SOLO il titolo in bianco -->
    <h2 class="line title white">{{ event.title }}</h2>

    <!-- Nome calligrafico e dettagli in rosso -->
    <h1 class="line name">{{ event.celebrant_name }}</h1>
    <p class="line for">per {{ event.degree }}</p>

    <p class="line when">{{ formatted_time }}</p>
    <p class="line where">{{ event.venue }}</p>
    <p class="line addr">{{ event.address }}</p>

    <div class="cta">
      <a id="waShare" class="btn" href="#" target="_blank" rel="noreferrer">Condividi su WhatsApp</a>
      <a class="btn" href="{{ event.gmaps_url }}" target="_blank" rel="noreferrer">Apri su Google Maps</a>
      <a class="btn" href="{{ event.rsvp_whatsapp }}" target="_blank" rel="noreferrer">RSVP su WhatsApp</a>
      <a class="btn" href="/download.ics">Aggiungi al Calendario (.ics)</a>
      <!-- QR rimosso come richiesto -->
    </div>
  </main>

  <!-- Layer per effetti (pipistrelli/zucche) -->
  <div id="fxLayer"></div>

  <!-- Script effetti (niente suoni) -->
  <script src="{{ url_for('static', filename='script.js') }}"></script>

  <!-- Inizializzazione link WhatsApp con i dati reali -->
  <script>
  (function () {
    const url = window.location.href.split('#')[0]; // URL pulito

    // Costruiamo il messaggio con vere newline
    const lines = [
      "Sei invitato alla festa di laurea di {{ event.celebrant_name }}!",
      "",
      "Festa di Laurea",
      "{{ formatted_time }}",
      "{{ event.venue }} – {{ event.address }}",
      `Apri l'invito qui: ${url}`,
      "Grazie!"
    ];
    const msg = lines.join('\n'); // <-- vere newline (\n), non stringhe "\\n"

    const a = document.getElementById('waShare');
    if (a) {
      const encoded = encodeURIComponent(msg);
      // Mobile e desktop: usa web.whatsapp su desktop per compatibilità
      a.href = /Android|iPhone|iPad/i.test(navigator.userAgent)
        ? `https://wa.me/?text=${encoded}`
        : `https://web.whatsapp.com/send?text=${encoded}`;
    }
  })();
</script>

</body>
</html>
